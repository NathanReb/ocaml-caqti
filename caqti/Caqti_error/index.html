<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Caqti_error (caqti.Caqti_error)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">caqti</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Caqti_error</span></h1></header><p>Error descriptors.</p><h3>Error Messages</h3><div class="spec type" id="type-msg"><a href="#type-msg" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>msg</code><code></code><code><span class="keyword"> = </span></code><code><span class="keyword">..</span></code><code></code></div><div class="doc"><p>In this type, drivers can stash information about an errors in ther own
format, which can later be used for pretty-printing and or future
operations. Drivers must <a href="index.html#val-define_msg">define_msg</a> on each constructor added to this
type.</p></div></div><div class="spec val" id="val-define_msg"><a href="#val-define_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>define_msg : pp:(Stdlib.Format.formatter <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> extension_constructor <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Mandatory registration of pretty-printer for a driver-supplied error
descriptor.</p></div></div><div class="spec val" id="val-pp_msg"><a href="#val-pp_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp_msg : Stdlib.Format.formatter <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">pp_msg ppf msg</code> formats <code class="code">msg</code> on <code class="code">ppf</code>.</p></div></div><div class="spec extension"><div class="def extension"><code><span class="keyword">type </span><a href="index.html#type-msg">msg</a><span class="keyword"> += </span></code><code><span class="extension">Msg</span><span class="keyword"> : </span>string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a></code></div><div class="doc"></div></div><h3>Error Records</h3><p><b>Note.</b> Please consider the fields internal for now, they may still be
revised or hidden.</p><div class="spec type" id="type-load_error"><a href="#type-load_error" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>load_error</code><code></code><code><span class="keyword"> = </span><span class="keyword">private </span></code><code>{</code><table class="record"><tr id="type-load_error.uri" class="anchored"><td class="def field"><a href="#type-load_error.uri" class="anchor"></a><code>uri : Uri.t;</code></td></tr><tr id="type-load_error.msg" class="anchored"><td class="def field"><a href="#type-load_error.msg" class="anchor"></a><code>msg : <a href="index.html#type-msg">msg</a>;</code></td></tr></table><code>}</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-connection_error"><a href="#type-connection_error" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>connection_error</code><code></code><code><span class="keyword"> = </span><span class="keyword">private </span></code><code>{</code><table class="record"><tr id="type-connection_error.uri" class="anchored"><td class="def field"><a href="#type-connection_error.uri" class="anchor"></a><code>uri : Uri.t;</code></td></tr><tr id="type-connection_error.msg" class="anchored"><td class="def field"><a href="#type-connection_error.msg" class="anchor"></a><code>msg : <a href="index.html#type-msg">msg</a>;</code></td></tr></table><code>}</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-query_error"><a href="#type-query_error" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>query_error</code><code></code><code><span class="keyword"> = </span><span class="keyword">private </span></code><code>{</code><table class="record"><tr id="type-query_error.uri" class="anchored"><td class="def field"><a href="#type-query_error.uri" class="anchor"></a><code>uri : Uri.t;</code></td></tr><tr id="type-query_error.query" class="anchored"><td class="def field"><a href="#type-query_error.query" class="anchor"></a><code>query : string;</code></td></tr><tr id="type-query_error.msg" class="anchored"><td class="def field"><a href="#type-query_error.msg" class="anchor"></a><code>msg : <a href="index.html#type-msg">msg</a>;</code></td></tr></table><code>}</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-coding_error"><a href="#type-coding_error" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>coding_error</code><code></code><code><span class="keyword"> = </span><span class="keyword">private </span></code><code>{</code><table class="record"><tr id="type-coding_error.uri" class="anchored"><td class="def field"><a href="#type-coding_error.uri" class="anchor"></a><code>uri : Uri.t;</code></td></tr><tr id="type-coding_error.typ" class="anchored"><td class="def field"><a href="#type-coding_error.typ" class="anchor"></a><code>typ : <a href="../Caqti_type/index.html#type-any">Caqti_type.any</a>;</code></td></tr><tr id="type-coding_error.msg" class="anchored"><td class="def field"><a href="#type-coding_error.msg" class="anchor"></a><code>msg : <a href="index.html#type-msg">msg</a>;</code></td></tr></table><code>}</code><code></code></div><div class="doc"></div></div><h3>Errors during Driver Loading</h3><div class="spec val" id="val-load_rejected"><a href="#val-load_rejected" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>load_rejected : uri:Uri.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Load_rejected of <a href="index.html#type-load_error">load_error</a> ]</code></div><div class="doc"><p><code class="code">load_rejected ~uri msg</code> indicates that the driver to load could not be
identified from <code class="code">uri</code>.</p></div></div><div class="spec val" id="val-load_failed"><a href="#val-load_failed" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>load_failed : uri:Uri.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Load_failed of <a href="index.html#type-load_error">load_error</a> ]</code></div><div class="doc"><p><code class="code">load_failed ~uri msg</code> indicates that a driver for <code class="code">uri</code> could not be
loaded.</p></div></div><h3>Errors during Connect</h3><div class="spec val" id="val-connect_rejected"><a href="#val-connect_rejected" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>connect_rejected : uri:Uri.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Connect_rejected of <a href="index.html#type-connection_error">connection_error</a> ]</code></div><div class="doc"><p><code class="code">connect_rejected ~uri msg</code> indicates that the driver rejected the URI.</p></div></div><div class="spec val" id="val-connect_failed"><a href="#val-connect_failed" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>connect_failed : uri:Uri.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Connect_failed of <a href="index.html#type-connection_error">connection_error</a> ]</code></div><div class="doc"><p><code class="code">connect_failed ~uri msg</code> indicates that the driver failed to establish a
connection to the database.</p></div></div><h3>Errors during Call</h3><div class="spec val" id="val-encode_missing"><a href="#val-encode_missing" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>encode_missing : uri:Uri.t <span class="keyword">&#8209;&gt;</span> field_type:<span class="type-var">'a</span> <a href="../Caqti_type/index.html#type-field">Caqti_type.field</a> <span class="keyword">&#8209;&gt;</span> unit <span class="keyword">&#8209;&gt;</span> [&gt; `Encode_rejected of <a href="index.html#type-coding_error">coding_error</a> ]</code></div><div class="doc"><p><code class="code">encode_missing ~uri ~field_type ()</code> indicates that the driver does not
support <code class="code">field_type</code> and no fallback encoding is available for the type.</p></div></div><div class="spec val" id="val-encode_rejected"><a href="#val-encode_rejected" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>encode_rejected : uri:Uri.t <span class="keyword">&#8209;&gt;</span> typ:<span class="type-var">'a</span> <a href="../Caqti_type/index.html#type-t">Caqti_type.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Encode_rejected of <a href="index.html#type-coding_error">coding_error</a> ]</code></div><div class="doc"><p><code class="code">encode_rejected ~uri ~typ msg</code> indicates that encoding a value to <code class="code">typ</code>
failed, e.g. due to being out of range.</p></div></div><div class="spec val" id="val-encode_failed"><a href="#val-encode_failed" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>encode_failed : uri:Uri.t <span class="keyword">&#8209;&gt;</span> typ:<span class="type-var">'a</span> <a href="../Caqti_type/index.html#type-t">Caqti_type.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Encode_failed of <a href="index.html#type-coding_error">coding_error</a> ]</code></div><div class="doc"><p><code class="code">encode_failed ~uri ~typ msg</code> indicates that a parameter of type <code class="code">typ</code> was
not accepted by the database driver.</p></div></div><div class="spec val" id="val-request_rejected"><a href="#val-request_rejected" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>request_rejected : uri:Uri.t <span class="keyword">&#8209;&gt;</span> query:string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Request_rejected of <a href="index.html#type-query_error">query_error</a> ]</code></div><div class="doc"><p><code class="code">request_rejected ~uri ~query msg</code> indicates that <code class="code">query</code> was not accepted
by the database or driver.</p></div></div><div class="spec val" id="val-request_failed"><a href="#val-request_failed" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>request_failed : uri:Uri.t <span class="keyword">&#8209;&gt;</span> query:string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Request_failed of <a href="index.html#type-query_error">query_error</a> ]</code></div><div class="doc"><p><code class="code">request_failed ~uri ~query msg</code> indicates that the request to could not be
transmitted to the database, that the database was not ready to process the
request, or that something went wrong while the request was being
processed.</p></div></div><h3>Errors during Result Retrieval</h3><div class="spec val" id="val-decode_missing"><a href="#val-decode_missing" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>decode_missing : uri:Uri.t <span class="keyword">&#8209;&gt;</span> field_type:<span class="type-var">'a</span> <a href="../Caqti_type/index.html#type-field">Caqti_type.field</a> <span class="keyword">&#8209;&gt;</span> unit <span class="keyword">&#8209;&gt;</span> [&gt; `Decode_rejected of <a href="index.html#type-coding_error">coding_error</a> ]</code></div><div class="doc"><p><code class="code">decode_missing ~uri ~field_type ()</code> indicates that the driver does not
support <code class="code">field_type</code> for decoding result rows.</p></div></div><div class="spec val" id="val-decode_rejected"><a href="#val-decode_rejected" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>decode_rejected : uri:Uri.t <span class="keyword">&#8209;&gt;</span> typ:<span class="type-var">'a</span> <a href="../Caqti_type/index.html#type-t">Caqti_type.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Decode_rejected of <a href="index.html#type-coding_error">coding_error</a> ]</code></div><div class="doc"><p><code class="code">decode_rejected ~uri ~typ msg</code> indicates that the driver could not decode a
field of type <code class="code">typ</code> from the returned row, e.g. due to an invalid value or
limited range of the target type.</p></div></div><div class="spec val" id="val-response_failed"><a href="#val-response_failed" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>response_failed : uri:Uri.t <span class="keyword">&#8209;&gt;</span> query:string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Response_failed of <a href="index.html#type-query_error">query_error</a> ]</code></div><div class="doc"><p><code class="code">response_failed ~uri ~query msg</code> indicates that something when wrong while
fetching a delayed part of the response.</p></div></div><div class="spec val" id="val-response_rejected"><a href="#val-response_rejected" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>response_rejected : uri:Uri.t <span class="keyword">&#8209;&gt;</span> query:string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-msg">msg</a> <span class="keyword">&#8209;&gt;</span> [&gt; `Response_rejected of <a href="index.html#type-query_error">query_error</a> ]</code></div><div class="doc"><p><code class="code">response_rejected ~uri ~query msg</code> indicates that the response from the
database was rejected due to requirements posed by client code.</p></div></div><h3>Error Sub-Types</h3><div class="spec type" id="type-call"><a href="#type-call" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>call</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-call.Encode_rejected" class="anchored"><td class="def constructor"><a href="#type-call.Encode_rejected" class="anchor"></a><code><span class="keyword">| </span></code><code>`Encode_rejected<span class="keyword"> of </span><a href="index.html#type-coding_error">coding_error</a></code></td></tr><tr id="type-call.Encode_failed" class="anchored"><td class="def constructor"><a href="#type-call.Encode_failed" class="anchor"></a><code><span class="keyword">| </span></code><code>`Encode_failed<span class="keyword"> of </span><a href="index.html#type-coding_error">coding_error</a></code></td></tr><tr id="type-call.Request_rejected" class="anchored"><td class="def constructor"><a href="#type-call.Request_rejected" class="anchor"></a><code><span class="keyword">| </span></code><code>`Request_rejected<span class="keyword"> of </span><a href="index.html#type-query_error">query_error</a></code></td></tr><tr id="type-call.Request_failed" class="anchored"><td class="def constructor"><a href="#type-call.Request_failed" class="anchor"></a><code><span class="keyword">| </span></code><code>`Request_failed<span class="keyword"> of </span><a href="index.html#type-query_error">query_error</a></code></td></tr><tr id="type-call.Response_rejected" class="anchored"><td class="def constructor"><a href="#type-call.Response_rejected" class="anchor"></a><code><span class="keyword">| </span></code><code>`Response_rejected<span class="keyword"> of </span><a href="index.html#type-query_error">query_error</a></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-retrieve"><a href="#type-retrieve" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>retrieve</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-retrieve.Decode_rejected" class="anchored"><td class="def constructor"><a href="#type-retrieve.Decode_rejected" class="anchor"></a><code><span class="keyword">| </span></code><code>`Decode_rejected<span class="keyword"> of </span><a href="index.html#type-coding_error">coding_error</a></code></td></tr><tr id="type-retrieve.Response_failed" class="anchored"><td class="def constructor"><a href="#type-retrieve.Response_failed" class="anchor"></a><code><span class="keyword">| </span></code><code>`Response_failed<span class="keyword"> of </span><a href="index.html#type-query_error">query_error</a></code></td></tr><tr id="type-retrieve.Response_rejected" class="anchored"><td class="def constructor"><a href="#type-retrieve.Response_rejected" class="anchor"></a><code><span class="keyword">| </span></code><code>`Response_rejected<span class="keyword"> of </span><a href="index.html#type-query_error">query_error</a></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-call_or_retrieve"><a href="#type-call_or_retrieve" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>call_or_retrieve</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-call_or_retrieve.call" class="anchored"><td class="def type"><a href="#type-call_or_retrieve.call" class="anchor"></a><code><span class="keyword">| </span></code><code><a href="index.html#type-call">call</a></code></td></tr><tr id="type-call_or_retrieve.retrieve" class="anchored"><td class="def type"><a href="#type-call_or_retrieve.retrieve" class="anchor"></a><code><span class="keyword">| </span></code><code><a href="index.html#type-retrieve">retrieve</a></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-transact"><a href="#type-transact" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>transact</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-transact.call" class="anchored"><td class="def type"><a href="#type-transact.call" class="anchor"></a><code><span class="keyword">| </span></code><code><a href="index.html#type-call">call</a></code></td></tr><tr id="type-transact.retrieve" class="anchored"><td class="def type"><a href="#type-transact.retrieve" class="anchor"></a><code><span class="keyword">| </span></code><code><a href="index.html#type-retrieve">retrieve</a></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-load"><a href="#type-load" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>load</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-load.Load_rejected" class="anchored"><td class="def constructor"><a href="#type-load.Load_rejected" class="anchor"></a><code><span class="keyword">| </span></code><code>`Load_rejected<span class="keyword"> of </span><a href="index.html#type-load_error">load_error</a></code></td></tr><tr id="type-load.Load_failed" class="anchored"><td class="def constructor"><a href="#type-load.Load_failed" class="anchor"></a><code><span class="keyword">| </span></code><code>`Load_failed<span class="keyword"> of </span><a href="index.html#type-load_error">load_error</a></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-connect"><a href="#type-connect" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>connect</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-connect.Connect_rejected" class="anchored"><td class="def constructor"><a href="#type-connect.Connect_rejected" class="anchor"></a><code><span class="keyword">| </span></code><code>`Connect_rejected<span class="keyword"> of </span><a href="index.html#type-connection_error">connection_error</a></code></td></tr><tr id="type-connect.Connect_failed" class="anchored"><td class="def constructor"><a href="#type-connect.Connect_failed" class="anchor"></a><code><span class="keyword">| </span></code><code>`Connect_failed<span class="keyword"> of </span><a href="index.html#type-connection_error">connection_error</a></code></td></tr><tr id="type-connect.Post_connect" class="anchored"><td class="def constructor"><a href="#type-connect.Post_connect" class="anchor"></a><code><span class="keyword">| </span></code><code>`Post_connect<span class="keyword"> of </span><a href="index.html#type-call_or_retrieve">call_or_retrieve</a></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-load_or_connect"><a href="#type-load_or_connect" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>load_or_connect</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-load_or_connect.load" class="anchored"><td class="def type"><a href="#type-load_or_connect.load" class="anchor"></a><code><span class="keyword">| </span></code><code><a href="index.html#type-load">load</a></code></td></tr><tr id="type-load_or_connect.connect" class="anchored"><td class="def type"><a href="#type-load_or_connect.connect" class="anchor"></a><code><span class="keyword">| </span></code><code><a href="index.html#type-connect">connect</a></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><h3>Error Type and Functions</h3><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-t.load" class="anchored"><td class="def type"><a href="#type-t.load" class="anchor"></a><code><span class="keyword">| </span></code><code><a href="index.html#type-load">load</a></code></td></tr><tr id="type-t.connect" class="anchored"><td class="def type"><a href="#type-t.connect" class="anchor"></a><code><span class="keyword">| </span></code><code><a href="index.html#type-connect">connect</a></code></td></tr><tr id="type-t.call" class="anchored"><td class="def type"><a href="#type-t.call" class="anchor"></a><code><span class="keyword">| </span></code><code><a href="index.html#type-call">call</a></code></td></tr><tr id="type-t.retrieve" class="anchored"><td class="def type"><a href="#type-t.retrieve" class="anchor"></a><code><span class="keyword">| </span></code><code><a href="index.html#type-retrieve">retrieve</a></code></td></tr></table><code> ]</code><code></code></div><div class="doc"><p>The full union of errors used by Caqti.</p></div></div><div class="spec val" id="val-uri"><a href="#val-uri" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>uri : [&lt; <a href="index.html#type-t">t</a> ] <span class="keyword">&#8209;&gt;</span> Uri.t</code></div><div class="doc"><p><code class="code">uri error</code> is the URI of the connection used where <code class="code">error</code> occurred.</p></div></div><div class="spec val" id="val-pp"><a href="#val-pp" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp : Stdlib.Format.formatter <span class="keyword">&#8209;&gt;</span> [&lt; <a href="index.html#type-t">t</a> ] <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">pp ppf error</code> prints an explanation of <code class="code">error</code> on <code class="code">ppf</code>.</p></div></div><div class="spec val" id="val-show"><a href="#val-show" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>show : [&lt; <a href="index.html#type-t">t</a> ] <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">show error</code> is an explanation of <code class="code">error</code>.</p></div></div><div class="spec exception" id="exception-Exn"><a href="#exception-Exn" class="anchor"></a><div class="def exception"><code><span class="keyword">exception </span></code><code><span class="exception">Exn</span><span class="keyword"> of </span><a href="index.html#type-t">t</a></code></div><div class="doc"><p><code class="code">Exn error</code> can be used when an exception is preferred over explicit error
handling. The core Caqti API never raises exceptions which originate from
runtime errors.</p></div></div></body></html>